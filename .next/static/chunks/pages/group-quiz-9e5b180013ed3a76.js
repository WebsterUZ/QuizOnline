(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[856],{4907:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/group-quiz",function(){return i(8253)}])},8253:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return s}});var n=i(5893),o=i(7294),r=i(7642);let d=window.location.origin;function s(){let[e,t]=(0,o.useState)(""),[i,s]=(0,o.useState)(""),[l,a]=(0,o.useState)(!1),[c,u]=(0,o.useState)([]),[g,p]=(0,o.useState)(""),[h,f]=(0,o.useState)("lobby"),[x,b]=(0,o.useState)(""),[y,m]=(0,o.useState)(!1),j=(0,o.useRef)(null),[k,S]=(0,o.useState)(0),[v,w]=(0,o.useState)({}),[z,R]=(0,o.useState)({}),[C,W]=(0,o.useState)(0),[I,B]=(0,o.useState)(!1),[q,A]=(0,o.useState)([]),[T,D]=(0,o.useState)([]);(0,o.useEffect)(()=>{if(!l)return;j.current||(j.current=(0,r.io)(d,{path:"/api/socket"}));let t=j.current;return t.emit("join-room",{roomId:e,player:i}),t.on("players-update",e=>{let{players:t,moderator:i}=e;u(t),p(i)}),t.on("moderator-changed",e=>{p(e)}),t.on("quiz-started",e=>{let{quizData:t}=e;f("quiz"),S(0),w({}),W(0),R({}),B(!1),D(t.map(e=>({...e,options:[...e.options].sort(()=>Math.random()-.5)})))}),t.on("player-answered",e=>{let{player:t,questionIndex:i}=e;console.log("".concat(t," answered question ").concat(i))}),t.on("quiz-finished",e=>{let{results:t}=e;A(t),B(!0),f("result")}),t.on("error",e=>{b(e),m(!1)}),()=>{t.off("players-update"),t.off("moderator-changed"),t.off("quiz-started"),t.off("player-answered"),t.off("quiz-finished"),t.off("error"),t.disconnect(),j.current=null}},[l,e,i]);let _=t=>{j.current&&j.current.emit("transfer-moderator",{roomId:e,toPlayer:t})},L=()=>{j.current&&j.current.emit("start-quiz",{roomId:e})},N=()=>{j.current&&j.current.emit("finish-quiz",{roomId:e})},X=t=>{void 0===v[k]&&(W(C+(t===T[k].correct?1:0)),w(e=>({...e,[k]:t})),j.current&&j.current.emit("answer",{roomId:e,player:i,answer:t,questionIndex:k}),setTimeout(()=>{E()},1e3))},E=()=>{k+1<T.length?S(k+1):j.current&&j.current.emit("finish-quiz",{roomId:e})};if(!l&&"lobby"===h)return(0,n.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(to bottom, #3b82f6, #a78bfa)"},children:(0,n.jsxs)("div",{style:{background:"white",padding:32,borderRadius:16,boxShadow:"0 4px 24px #0001",width:400},children:[(0,n.jsx)("h2",{style:{textAlign:"center",marginBottom:24,fontWeight:700,fontSize:24},children:"Guruh Test Xonasiga Qo'shiling"}),x&&(0,n.jsx)("div",{style:{color:"red",marginBottom:16},children:x}),(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:500},children:"Ismingiz"}),(0,n.jsx)("input",{type:"text",placeholder:"Ismingizni kiriting",value:i,onChange:e=>s(e.target.value),style:{width:"100%",padding:16,fontSize:18,borderRadius:8,border:"1px solid #ccc"},autoComplete:"off"})]}),(0,n.jsxs)("div",{style:{marginBottom:16},children:[(0,n.jsx)("label",{style:{display:"block",marginBottom:8,fontWeight:500},children:"Xona ID"}),(0,n.jsx)("input",{type:"text",placeholder:"Xona ID sini kiriting",value:e,onChange:e=>t(e.target.value),style:{width:"100%",padding:16,fontSize:18,borderRadius:8,border:"1px solid #ccc"}})]}),(0,n.jsx)("button",{type:"button",style:{width:"100%",padding:16,fontSize:18,borderRadius:8,background:"#2563eb",color:"white",border:"none",fontWeight:700,cursor:"pointer"},disabled:!i.trim()||!e.trim(),onClick:()=>a(!0),children:"Xonaga qo'shilish"})]})});if("waiting"===h)return(0,n.jsxs)("div",{style:{minHeight:"100vh",display:"flex",background:"linear-gradient(to bottom, #3b82f6, #a78bfa)"},children:[(0,n.jsxs)("div",{style:{width:260,background:"#f3f4f6",padding:24,borderRight:"1px solid #e5e7eb",display:"flex",flexDirection:"column",gap:12,overflowY:"auto"},children:[(0,n.jsx)("div",{style:{fontWeight:700,fontSize:18,marginBottom:12},children:"Ishtirokchilar"}),c.map(e=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,background:e===i?"#dbeafe":"transparent",borderRadius:8,padding:8},children:[(0,n.jsx)("span",{style:{fontWeight:500,color:e===g?"#16a34a":"#374151"},children:e}),e===g&&(0,n.jsx)("span",{style:{fontSize:12,background:"#bbf7d0",color:"#166534",borderRadius:6,padding:"2px 8px",marginLeft:4},children:"moderator"}),i===g&&e!==g&&(0,n.jsx)("button",{style:{marginLeft:"auto",fontSize:12,background:"#fef9c3",color:"#b45309",border:"none",borderRadius:6,padding:"2px 8px",cursor:"pointer"},onClick:()=>_(e),children:"Moderlikni berish"}),e===i&&(!g||e!==g)&&(0,n.jsx)("span",{style:{fontSize:12,background:"#e0e7ff",color:"#3730a3",borderRadius:6,padding:"2px 8px",marginLeft:4},children:"Siz"})]},e))]}),(0,n.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:(0,n.jsxs)("div",{style:{background:"white",padding:32,borderRadius:16,boxShadow:"0 4px 24px #0001",width:400},children:[(0,n.jsxs)("h2",{style:{textAlign:"center",marginBottom:24,fontWeight:700,fontSize:24},children:["Xona ID: ",(0,n.jsx)("span",{style:{fontFamily:"monospace"},children:e})]}),(0,n.jsx)("div",{style:{textAlign:"center",marginBottom:24,color:"#6b7280"},children:i===g?"Siz moderator siz. Testni boshlang yoki moderlikni boshqasiga bering.":"Moderator testni boshlashini kuting..."}),i===g&&(0,n.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[(0,n.jsx)("button",{type:"button",style:{padding:"12px 24px",fontSize:18,borderRadius:8,background:"#22c55e",color:"white",border:"none",fontWeight:700,cursor:"pointer"},onClick:L,children:"Start"}),(0,n.jsx)("button",{type:"button",style:{padding:"12px 24px",fontSize:18,borderRadius:8,background:"#ef4444",color:"white",border:"none",fontWeight:700,cursor:"pointer"},onClick:N,children:"Stop"})]})]})})]});if("quiz"===h){let e=T[k],t=v[k],o=i===g;return(0,n.jsxs)("div",{style:{minHeight:"100vh",display:"flex",background:"linear-gradient(to bottom, #3b82f6, #a78bfa)"},children:[(0,n.jsxs)("div",{style:{width:260,background:"#f3f4f6",padding:24,borderRight:"1px solid #e5e7eb",display:"flex",flexDirection:"column",gap:12,overflowY:"auto"},children:[(0,n.jsx)("div",{style:{fontWeight:700,fontSize:18,marginBottom:12},children:"Ishtirokchilar"}),c.map(e=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,background:e===i?"#dbeafe":"transparent",borderRadius:8,padding:8},children:[(0,n.jsx)("span",{style:{fontWeight:500,color:e===g?"#16a34a":"#374151"},children:e}),e===g&&(0,n.jsx)("span",{style:{fontSize:12,background:"#bbf7d0",color:"#166534",borderRadius:6,padding:"2px 8px",marginLeft:4},children:"moderator"}),i===g&&e!==g&&(0,n.jsx)("button",{style:{marginLeft:"auto",fontSize:12,background:"#fef9c3",color:"#b45309",border:"none",borderRadius:6,padding:"2px 8px",cursor:"pointer"},onClick:()=>_(e),children:"Moderlikni berish"}),e===i&&(!g||e!==g)&&(0,n.jsx)("span",{style:{fontSize:12,background:"#e0e7ff",color:"#3730a3",borderRadius:6,padding:"2px 8px",marginLeft:4},children:"Siz"})]},e))]}),(0,n.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"24px"},children:(0,n.jsxs)("div",{style:{background:"white",padding:32,borderRadius:16,boxShadow:"0 4px 24px #0001",maxWidth:600,width:"100%"},children:[(0,n.jsxs)("div",{style:{marginBottom:24,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsxs)("h3",{style:{fontWeight:700,fontSize:20},children:["Savol ",k+1," / ",T.length]}),o&&(0,n.jsx)("button",{type:"button",style:{padding:"8px 16px",fontSize:14,borderRadius:8,background:"#ef4444",color:"white",border:"none",fontWeight:700,cursor:"pointer"},onClick:N,children:"Stop Test"})]}),(0,n.jsx)("p",{style:{fontSize:18,marginBottom:24},children:e.question}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:e.options.map((i,o)=>(0,n.jsx)("button",{type:"button",onClick:()=>X(i),disabled:void 0!==t,style:{width:"100%",textAlign:"left",padding:16,fontSize:16,borderRadius:8,border:"1px solid #ccc",background:t===i?i===e.correct?"#dbeafe":"#fee2e2":void 0!==t&&i===e.correct?"#dbeafe":"#f9fafb",color:t===i?i===e.correct?"#1e40af":"#991b1b":void 0!==t&&i===e.correct?"#1e40af":"1f2937",cursor:void 0!==t?"not-allowed":"pointer",fontWeight:void 0!==t&&i===e.correct?700:400},children:i},o))}),void 0!==t&&(0,n.jsx)("div",{style:{marginTop:16,textAlign:"center",color:t===e.correct?"#16a34a":"#ef4444",fontWeight:700},children:t===e.correct?"To'g'ri javob!":"Noto'g'ri javob. To'g'risi: ".concat(e.correct)}),void 0!==t&&(0,n.jsx)("button",{type:"button",style:{marginTop:24,width:"100%",padding:12,fontSize:16,borderRadius:8,background:"#2563eb",color:"white",border:"none",fontWeight:700,cursor:"pointer"},onClick:E,children:"Keyingi savol"})]})})]})}return"result"===h?(0,n.jsx)("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(to bottom, #3b82f6, #a78bfa)"},children:(0,n.jsxs)("div",{style:{background:"white",padding:32,borderRadius:16,boxShadow:"0 4px 24px #0001",width:500},children:[(0,n.jsx)("h2",{style:{textAlign:"center",marginBottom:24,fontWeight:700,fontSize:24},children:"Test yakunlandi!"}),(0,n.jsx)("div",{style:{fontWeight:700,fontSize:18,marginBottom:16},children:"Natijalar:"}),(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{style:{borderBottom:"2px solid #eee"},children:[(0,n.jsx)("th",{style:{padding:"12px 8px",textAlign:"left"},children:"Ishtirokchi"}),(0,n.jsx)("th",{style:{padding:"12px 8px",textAlign:"center"},children:"To'g'ri"}),(0,n.jsx)("th",{style:{padding:"12px 8px",textAlign:"center"},children:"Noto'g'ri"}),(0,n.jsx)("th",{style:{padding:"12px 8px",textAlign:"center"},children:q.length>0?"".concat(q[0].totalQuestions," (%)"):"Umumiy savollar (%)"})]})}),(0,n.jsx)("tbody",{children:q.map((e,t)=>{let i=e.totalQuestions-e.score,o=e.totalQuestions>0?(e.score/e.totalQuestions*100).toFixed(1):0;return(0,n.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,n.jsxs)("td",{style:{padding:"12px 8px",fontWeight:0===t?700:400,color:0===t?"#10b981":"#1f2937"},children:[t+1,". ",e.name]}),(0,n.jsx)("td",{style:{padding:"12px 8px",textAlign:"center",color:"#10b981"},children:e.score}),(0,n.jsx)("td",{style:{padding:"12px 8px",textAlign:"center",color:"#ef4444"},children:i}),(0,n.jsxs)("td",{style:{padding:"12px 8px",textAlign:"center"},children:[o," (%)"]})]},e.name)})})]}),(0,n.jsx)("button",{type:"button",style:{marginTop:24,width:"100%",padding:12,fontSize:16,borderRadius:8,background:"#2563eb",color:"white",border:"none",fontWeight:700,cursor:"pointer"},onClick:()=>window.location.reload(),children:"Yangi test boshlash"})]})}):(0,n.jsxs)("div",{style:{minHeight:"100vh",display:"flex",background:"linear-gradient(to bottom, #3b82f6, #a78bfa"},children:[(0,n.jsxs)("div",{style:{width:260,background:"#f3f4f6",padding:24,borderRight:"1px solid #e5e7eb",display:"flex",flexDirection:"column",gap:12,overflowY:"auto"},children:[(0,n.jsx)("div",{style:{fontWeight:700,fontSize:18,marginBottom:12},children:"Ishtirokchilar"}),c.map(e=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,background:e===i?"#dbeafe":"transparent",borderRadius:8,padding:8},children:[(0,n.jsx)("span",{style:{fontWeight:500,color:e===g?"#16a34a":"#374151"},children:e}),e===g&&(0,n.jsx)("span",{style:{fontSize:12,background:"#bbf7d0",color:"#166534",borderRadius:6,padding:"2px 8px",marginLeft:4},children:"moderator"}),i===g&&e!==g&&(0,n.jsx)("button",{style:{marginLeft:"auto",fontSize:12,background:"#fef9c3",color:"#b45309",border:"none",borderRadius:6,padding:"2px 8px",cursor:"pointer"},onClick:()=>_(e),children:"Moderlikni berish"}),e===i&&(!g||e!==g)&&(0,n.jsx)("span",{style:{fontSize:12,background:"#e0e7ff",color:"#3730a3",borderRadius:6,padding:"2px 8px",marginLeft:4},children:"Siz"})]},e))]}),(0,n.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:(0,n.jsxs)("div",{style:{background:"white",padding:32,borderRadius:16,boxShadow:"0 4px 24px #0001",width:400},children:[(0,n.jsxs)("h2",{style:{textAlign:"center",marginBottom:24,fontWeight:700,fontSize:24},children:["Xona ID: ",(0,n.jsx)("span",{style:{fontFamily:"monospace"},children:e})]}),(0,n.jsx)("div",{style:{textAlign:"center",marginBottom:24,color:"#6b7280"},children:i===g?"Siz moderator siz. Testni boshlang yoki moderlikni boshqasiga bering.":"Moderator testni boshlashini kuting..."}),i===g&&(0,n.jsxs)("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[(0,n.jsx)("button",{type:"button",style:{padding:"12px 24px",fontSize:18,borderRadius:8,background:"#22c55e",color:"white",border:"none",fontWeight:700,cursor:"pointer"},onClick:L,children:"Start"}),(0,n.jsx)("button",{type:"button",style:{padding:"12px 24px",fontSize:18,borderRadius:8,background:"#ef4444",color:"white",border:"none",fontWeight:700,cursor:"pointer"},onClick:N,children:"Stop"})]})]})})]})}}},function(e){e.O(0,[642,888,774,179],function(){return e(e.s=4907)}),_N_E=e.O()}]);